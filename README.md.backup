# easm-rnd

A modern monorepo, modular, extensible, reusable application for External Attack Surface Management (EASM) Research and Development, built with Django REST API and GRAPHQL backend and React TypeScript frontend.

## ğŸ“ Project Structure

This project follows a modular monorepo architecture inspired by and customized from the [Pitchfork Layout](https://joholl.github.io/pitchfork-website/) for our Python/Django backend and TypeScript/React frontend stack. The structure emphasizes separation of concerns, modularity, and scalability.

```
easm-platform/
â”œâ”€â”€ src/                        # Source code directory
â”‚   â”œâ”€â”€ backend/                # Django backend applications and libraries
â”‚   â”‚   â”œâ”€â”€ easm/               # Main Django project (domain-driven design)
â”‚   â”‚   â”‚   â”œâ”€â”€ apps/           # ğŸ“¦ All Django Applications
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ api/        # ğŸ¨ API Layer - REST endpoints (Presentation)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ asset/      # ï¿½ Asset Discovery Domain
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ authentication/ # ğŸ” Legacy Authentication (to be migrated)
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ core/       # ğŸ—ï¸ Core Infrastructure
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ example/    # ğŸ“š Example Domain (legacy)
â”‚   â”‚   â”‚   â”œâ”€â”€ sample/         # ğŸ“š Sample/Template App - FOLLOW THIS STRUCTURE
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ apps.py     # App configuration
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ models.py   # Database models
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ serializers.py # DRF serializers
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ views.py    # ViewSets and views
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ urls.py     # URL patterns
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ admin.py    # Django admin config
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ filters.py  # Custom filters for querysets
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ permissions.py # Custom permissions
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ services/   # ï¿½ Business logic layer
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ sample_service.py # Service classes
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tasks/      # ğŸ“‹ Celery async tasks
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ sample_tasks.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ utils/      # ğŸ› ï¸ Domain-specific utilities
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ helpers.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ management/ # Django management commands
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ commands/
â”‚   â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ seed_sample.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ migrations/ # Database migrations
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tests/      # Unit and integration tests
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ test_models.py
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ test_views.py
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ test_services.py
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ README.md   # ğŸ“– Documentation for creating new apps
â”‚   â”‚   â”‚   â”œâ”€â”€ asset/          # ï¿½ Asset Discovery Domain - models, services, tasks
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/           # ğŸ” Authentication Domain - user management
â”‚   â”‚   â”‚   â”œâ”€â”€ core/           # ğŸ—ï¸ Core Infrastructure - base models, permissions
â”‚   â”‚   â”‚   â”œâ”€â”€ common/         # ğŸ› ï¸ Common Utilities - helpers, validators
â”‚   â”‚   â”‚   â”œâ”€â”€ config/         # âš™ï¸ Django Configuration - settings, URLs, WSGI
â”‚   â”‚   â”‚   â”œâ”€â”€ pyproject.toml  # Poetry dependencies and project metadata
â”‚   â”‚   â”‚   â””â”€â”€ manage.py       # Django management command entry point
â”‚   â”‚   â””â”€â”€ easm-core/          # Shared Python libraries across backend projects
â”‚   â”œâ”€â”€ frontend/               # React TypeScript frontend applications
â”‚   â”‚   â”œâ”€â”€ easm-user-portal/   # ğŸŒ Main user-facing portal interface
â”‚   â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ features/   # Domain-specific feature modules
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ shared/     # App-specific shared components
â”‚   â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”‚   â””â”€â”€ tsconfig.json
â”‚   â”‚   â”œâ”€â”€ easm-admin-portal/  # ğŸ›¡ï¸ Administrative dashboard (in development)
â”‚   â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ easm-core/          # Shared TypeScript utilities and types
â”‚   â”‚   â””â”€â”€ easm-react/         # ğŸ§© Shared React component library
â”‚   â”œâ”€â”€ charts/                 # Helm charts for Kubernetes deployment
â”‚   â”‚   â”œâ”€â”€ api/                # Backend API Helm chart
â”‚   â”‚   â””â”€â”€ user-portal/        # User portal Helm chart
â”‚   â””â”€â”€ cli/                    # Command-line tools and utilities
â”‚       â””â”€â”€ easm-cli/           # CLI for development and deployment automation
â”œâ”€â”€ infra/                      # Infrastructure as Code (IaC)
â”‚   â”œâ”€â”€ helm/                   # Additional Helm charts and values
â”‚   â”œâ”€â”€ docker/                 # Custom Dockerfiles and build contexts
â”‚   â””â”€â”€ k8s/                    # Raw Kubernetes manifests
â”œâ”€â”€ docs/                       # Comprehensive project documentation
â”‚   â”œâ”€â”€ API-DOCUMENTATION.md    # API reference and examples
â”‚   â”œâ”€â”€ DEPLOYMENT.md           # Deployment guides
â”‚   â””â”€â”€ GIT-WORKFLOW.md         # Git workflow and conventions
â”œâ”€â”€ tests/                      # Integration and end-to-end tests
â”œâ”€â”€ tools/                      # Development scripts and utilities
â”‚   â”œâ”€â”€ Makefile                # Build automation commands
â”‚   â”œâ”€â”€ delete-package.ps1      # GHCR package management script
â”‚   â””â”€â”€ verify-setup.ps1        # Environment verification script
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/              # CI/CD pipelines (GitHub Actions)
â”œâ”€â”€ skaffold.yaml               # Skaffold configuration for local K8s development
â”œâ”€â”€ docker-compose.yml          # Docker Compose for local development
â””â”€â”€ README.md
```

**Key Design Principles:**
- **Modularity**: Each component (backend/frontend modules) is independently maintainable
- **Separation**: Clear boundaries between Django apps, configuration, and shared utilities
- **Scalability**: Easy to add new modules or services without affecting existing ones
- **Reusability**: Shared libraries (`easm-core`, `easm-react`) and common utilities promote code reuse
- **Django Apps Organization**: All domain applications reside under `easm/apps/` for clear namespace separation
- **Template-First**: The `sample` app serves as a reference implementation for creating new Django apps

**ğŸ“š Sample App Structure:**
The `easm/sample/` folder demonstrates the recommended structure for all new Django applications:
- **Core Files**: `models.py`, `serializers.py`, `views.py`, `urls.py`, `admin.py`, `apps.py`
- **Advanced Features**: `filters.py`, `permissions.py` for custom DRF functionality
- **Business Logic**: `services/` directory for domain-specific business logic (service layer pattern)
- **Async Tasks**: `tasks/` directory for Celery background tasks
- **Utilities**: `utils/` for domain-specific helper functions
- **Management**: `management/commands/` for custom Django management commands
- **Testing**: Dedicated `tests/` directory with organized test files
- **Documentation**: `README.md` with guidelines for creating new apps following this pattern


### Frontend App Structure

```
frontend/
â”œâ”€â”€ easm-user-portal/             # Main EASM Portal (User-facing)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ features/            # Domain-specific modules
â”‚   â”‚   â”œâ”€â”€ shared/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .gitignore
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ easm-admin-portal/              # Admin Portal (Administrative interface)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ features/            # Admin-specific features
â”‚   â”‚   â””â”€â”€ shared/
â”‚   â”‚       â””â”€â”€ components/      # Admin-specific shared components
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .gitignore
â”‚   â””â”€â”€ README.md                # ğŸš§ Under development
â”‚
â””â”€â”€ easm-react/                  # Shared UI Library
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ components/          # Shared components across apps
    â”‚   â”œâ”€â”€ utils/               # Utility functions
    â”‚   â”œâ”€â”€ hooks/               # Custom React hooks
    â”‚   â”œâ”€â”€ types/               # TypeScript type definitions
    â”‚   â””â”€â”€ index.ts
    â”œâ”€â”€ package.json
    â”œâ”€â”€ tsconfig.json
    â”œâ”€â”€ .gitignore
    â””â”€â”€ README.md
```

**Note:** Each app (easm-user-portal, easm-admin-portal) has its own `shared/` directory for app-specific shared components. The `easm-react` package contains components and utilities shared across all EASM applications.

## ğŸš€ Tech Stack

| Category        | Name       | Version | Environment | Description                                                    |
|-----------------|------------|---------|-------------|----------------------------------------------------------------|
| **Infra**       | Docker     | 28.5+   | All         | Platform for developing, shipping, and running containers      |
| **Infra**       | Kubernetes | 1.32+   | All         | Production-grade container orchestration platform              |
| **Infra**       | Minikube   | 1.35+   | Local       | Local Kubernetes cluster for development and testing           |
| **Infra**       | Skaffold   | 2.16+   | Local, Dev  | Command-line tool for continuous development on Kubernetes     |
| **Infra**       | Helm       | 3.19+   | All         | Package manager for Kubernetes applications                    |
| **Backend**     | Python     | 3.13+   | All         | Python runtime for backend services                            |
| **Backend**     | Django     | 5.2+    | All         | High-level Python web framework (LTS)                          |
| **Backend**     | Poetry     | 2.2+    | All         | Python dependency management and packaging tool                |
| **Backend**     | PostgreSQL | 18+     | All         | Advanced open-source relational database                       |
| **Backend**     | MongoDB    | 8+      | All         | NoSQL document database for flexible data storage              |
| **Backend**     | Redis      | 8+      | All         | In-memory data structure store for caching and sessions        |
| **Frontend**    | Node.js    | 22+     | All         | JavaScript runtime environment                                 |
| **Frontend**    | React      | 19+     | All         | Component-based JavaScript library for building user interfaces|
| **Frontend**    | TypeScript | 5.7+    | All         | Typed superset of JavaScript for enhanced code quality         |
| **Frontend**    | Vite       | 6+      | All         | Next-generation frontend build tool with HMR                   |
| **Frontend**    | Turborepo  | 2+      | All         | High-performance build system for JavaScript/TypeScript monorepos|

## ğŸƒ Getting Started

### Quick Start with CLI

# 2. Install CLI
pipx install src/cli/easm-cli

# 3. Start development
easm dev start

# 4. Stop
easm dev stop
```

**For complete CLI documentation, installation options, and command reference, see [CLI README](src/cli/easm-cli/README.md)**

### Environment Configuration

This project uses a **single environment file** (`.env`) for all deployment modes.

```bash
# Copy the example environment file
cp .env.example .env

# Edit .env with your configuration
# Update SECRET_KEY, POSTGRES_PASSWORD, and other values as needed
```

### Local Development with Docker Compose

```bash
# Manual method
docker-compose up -d

# Or use CLI
python src/cli/easm.py dev start --mode compose

# Backend setup
cd src/backend
poetry install
poetry run python manage.py migrate
poetry run python manage.py createsuperuser

# Frontend setup (new terminal)
cd src/frontend
pnpm install
pnpm dev
```

### Local Development with Minikube & Skaffold

```bash
# Using CLI (automatically starts Minikube if needed)
python src/cli/easm.py dev start --mode k8s

# Or use the interactive deployment script
# PowerShell:
.\skaffold.ps1

# Bash/Linux/macOS:
./skaffold.sh

# Manual method
minikube start --cpus=4 --memory=8192 --driver=docker
minikube addons enable ingress
skaffold dev

# Access services
minikube service list
```

**Note:** The CLI and deployment scripts automatically:
- Load environment variables from `.env`
- Start Minikube if Kubernetes is not running
- Generate temporary Skaffold config with your custom ports
- Clean up temporary files after deployment

### Manual Kubernetes Deployment

```bash
# Build and push images
docker build -t easm-backend:latest ./src/backend
docker build -t easm-user-portal:latest ./src/frontend

# Deploy with Helm
helm install easm-platform ./infra/helm/easm-platform \
  --namespace easm-platform \
  --create-namespace \
  --values ./infra/helm/easm-platform/values-dev.yaml
```



## ğŸŒ¿ Git Workflow

We follow Git Flow branching strategy with Conventional Commits specification.

**ğŸ“– Complete Guide:** [Git Workflow & Commit Conventions](docs/GIT-WORKFLOW.md)

This guide includes:
- **Commit Message Convention** - Conventional Commits format, types, and examples
- **Branch Naming** - Branch types and naming conventions
- **Branch Workflow** - Creating and managing feature, bugfix, hotfix, and release branches
- **Pull Request Process** - PR creation with templates and checklists
- **Code Review Guidelines** - Best practices for reviewing and approving PRs
- **Branch Protection Rules** - Merge strategies and protection settings

## ğŸš¢ Release Process

### Automated Release with GitHub Actions

Our CI/CD pipeline automatically deploys to Proxmox Kubernetes cluster:

#### Workflow Triggers

- **Push to `main`** - Deploy to production
- **Push to `develop`** - Deploy to staging
- **Pull Request** - Run tests and build checks
- **Tag `v*`** - Create GitHub release and deploy

#### Environment Variables Required

Set these in GitHub Repository Settings â†’ Secrets:

```yaml
PROXMOX_K8S_CLUSTER    # Kubernetes cluster URL
PROXMOX_K8S_TOKEN      # Service account token
PROXMOX_K8S_CA_CERT    # Cluster CA certificate
DOCKER_REGISTRY        # Docker registry URL
DOCKER_USERNAME        # Registry username
DOCKER_PASSWORD        # Registry password
HELM_REPO_URL          # Helm chart repository
DATABASE_URL           # PostgreSQL connection string
REDIS_URL              # Redis connection string
RABBITMQ_URL           # RabbitMQ connection string
SECRET_KEY             # Django secret key
```

### Manual Release Steps

```bash
# 1. Create release branch
git checkout develop
git checkout -b release/v1.2.0

# 2. Update version numbers
# src/backend/pyproject.toml
# src/frontend/package.json
# infra/helm/easm-platform/Chart.yaml

# 3. Update CHANGELOG.md
# Document all changes since last release

# 4. Commit version bump
git commit -am "chore(release): bump version to 1.2.0"

# 5. Merge to main
git checkout main
git merge release/v1.2.0

# 6. Create and push tag
git tag -a v1.2.0 -m "Release version 1.2.0"
git push origin main --tags

# 7. Merge back to develop
git checkout develop
git merge release/v1.2.0
git push origin develop

# 8. Delete release branch
git branch -d release/v1.2.0
git push origin --delete release/v1.2.0
```

### Rollback Procedure

```bash
# Rollback to previous Helm release
helm rollback easm-platform -n easm-platform

# Or rollback to specific revision
helm rollback easm-platform 3 -n easm-platform

# Check rollback status
helm history easm-platform -n easm-platform
```

## ğŸ§ª Testing

```bash
# Backend tests
cd src/backend
poetry run pytest
poetry run pytest --cov=apps

# Frontend tests
cd src/frontend
pnpm test
pnpm test:coverage

# E2E tests
pnpm test:e2e
```

## ğŸ“Š Monitoring

- **Application**: Django Debug Toolbar (dev), Sentry (prod)
- **Infra**: Prometheus + Grafana
- **Logs**: ELK Stack (Elasticsearch, Logstash, Kibana)
- **Tracing**: Jaeger

## ğŸ”’ Security

| Security Feature              | Status      | Backend | Frontend | Description                                    |
|-------------------------------|-------------|---------|----------|------------------------------------------------|
| HTTPS/TLS Encryption          | âŒ Done     | âŒ      | âŒ       | Secure communication with SSL/TLS              |
| JWT Authentication            | âœ… Done     | âœ…      | âœ…       | Token-based authentication system              |
| CORS Configuration            | âœ… Done     | âœ…      | âœ…       | Cross-Origin Resource Sharing properly configured |
| Rate Limiting                 | âŒ Done     | âŒ      | âŒ       | API rate limiting to prevent abuse             |
| SQL Injection Prevention      | âŒ Done     | âŒ      | âŒ       | Django ORM protection against SQL injection    |
| XSS Protection                | âŒ Done     | âŒ      | âŒ       | Cross-Site Scripting prevention mechanisms     |
| CSRF Tokens                   | âŒ Done     | âŒ      | âŒ       | Cross-Site Request Forgery protection          |
| Security Headers              | âŒ Done     | âŒ      | âŒ       | HSTS, CSP, X-Frame-Options, etc.               |
| Input Validation              | âŒ Done     | âŒ      | âŒ       | Server and client-side input validation        |
| Password Hashing              | âœ… Done     | âœ…      | âœ…       | Bcrypt/PBKDF2 for secure password storage      |
| Environment Variables         | âŒ Done     | âŒ      | âŒ       | Sensitive data stored in environment variables |
| Dependency Scanning           | âŒ Progress | âŒ      | âŒ       | Automated vulnerability scanning for dependencies |
| API Key Management            | âŒ Planned  | âŒ      | âŒ       | Secure API key rotation and management         |
| Two-Factor Authentication     | âŒ Planned  | âŒ      | âŒ       | 2FA for enhanced user security                 |
| Security Audit Logging        | âŒ Planned  | âŒ      | âŒ       | Comprehensive security event logging           |

**Legend:**
- âœ… Done - Implemented and active
- ğŸ”„ Progress - In development
- ğŸ“‹ Planned - Scheduled for future implementation
- âŒ Not applicable or not implemented

## ğŸ“š Documentation

- **API Documentation**: `/api/docs/` (Swagger/OpenAPI)
- **API Schema**: `/api/schema/`
- **Admin Panel**: `/admin/`

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes using conventional commits
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request to `develop` branch

## ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

##  Support

- **Issues**: [GitHub Issues](https://github.com/SecPod-Git/easm/issues)
- **Discussions**: [GitHub Discussions](https://github.com/SecPod-Git/easm/discussions)
- **Email**: support@your-domain.com

---

Built with â¤ï¸ by the EASM R&D Team
